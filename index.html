<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Mini Jogo Fugitivo - Sound Edition</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    
    <style>
        /* Estilos base (Igual ao anterior com melhorias visuais) */
        body { text-align: center; font-family: sans-serif; background-color: #f0f4f8; transition: 0.3s; padding: 20px; }
        body.dark-mode { background-color: #121212; color: #e0e0e0; }
        
        #main-layout { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 20px; }
        
        #game-container { 
            background: white; width: 80vw; max-width: 600px; height: 400px; 
            border-radius: 15px; position: relative; border: 3px solid #00bfff; 
            overflow: hidden; box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        .dark-mode #game-container { background: #1e1e1e; border-color: #bb86fc; }

        #fugitive-button { 
            background-color: #ff4757; color: white; border: none; padding: 10px 15px;
            font-weight: bold; border-radius: 8px; cursor: pointer; position: absolute; z-index: 10;
        }

        .obstacle { position: absolute; background-color: #adb5bd; border-radius: 5px; z-index: 5; pointer-events: none; opacity: 0.6; }
        .dark-mode .obstacle { background-color: #3700b3; border: 1px solid #bb86fc; }

        #ranking-container { width: 250px; background: #fff; padding: 15px; border-radius: 15px; text-align: left; }
        .dark-mode #ranking-container { background: #1e1e1e; }
        
        .stats { font-size: 20px; font-weight: bold; margin-bottom: 10px; color: #0077b6; }
        .dark-mode .stats { color: #03dac6; }
    </style>
</head>
<body>

    <h1>Mini Jogo Fugitivo üéÆ</h1>
    
    <div id="controls">
        <input type="text" id="player-id" placeholder="Teu ID" maxlength="10">
        <select id="difficulty-select" onchange="configurarDificuldade()">
            <option value="easy">F√°cil</option>
            <option value="medium">M√©dio</option>
            <option value="hard">Dif√≠cil</option>
        </select>
        <button onclick="toggleDarkMode()">üåì Tema</button>
    </div>

    <div id="main-layout">
        <div>
            <div class="stats">
                <span id="timer">Tempo: 0.0s</span> | 
                <span>Cliques: <span id="score">0</span></span>
            </div>
            <div id="game-container">
                <button id="fugitive-button" onclick="cliqueBotao()">PEGUE-ME!</button>
            </div>
        </div>
        
        <div id="ranking-container">
            <h3>üèÜ Top 10</h3>
            <div id="ranking-list">Carregando...</div>
        </div>
    </div>

    <script>
        // --- CONFIGURA√á√ÉO FIREBASE (Usa as tuas credenciais aqui) ---
        const firebaseConfig = {
          apiKey: "AIzaSyAjfuzzPSyfEmfbw13qf-K-OlSd9yugeOE",
          authDomain: "mini-jogo-fugitivo.firebaseapp.com",
          projectId: "mini-jogo-fugitivo",
          storageBucket: "mini-jogo-fugitivo.firebasestorage.app",
          messagingSenderId: "1037732757514",
          appId: "1:1037732757514:web:a72365c217941c23339ff3"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // --- SONS ---
        // Som de "Beep" curto para o clique
        const somClique = new Audio('https://www.soundjay.com/buttons/sounds/button-3.mp3');
        // Som de "Game Over" para o fim
        const somFim = new Audio('https://www.soundjay.com/buttons/sounds/button-10.mp3');

        // --- VARI√ÅVEIS ---
        const TEMPOS = { easy: 15, medium: 10, hard: 5 };
        let pontos = 0, dificuldadeAtual = 'easy', tempoRestante, cronometro, jogoAtivo = false;

        const botao = document.getElementById("fugitive-button");
        const container = document.getElementById("game-container");

        function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }

        function gerarObstaculos() {
            document.querySelectorAll('.obstacle').forEach(o => o.remove());
            if (dificuldadeAtual === 'easy') return;
            const qtd = dificuldadeAtual === 'hard' ? 6 : 3;
            for (let i = 0; i < qtd; i++) {
                const obs = document.createElement('div');
                obs.className = 'obstacle';
                const tam = Math.random() * 50 + 30;
                obs.style.width = tam + 'px'; obs.style.height = tam + 'px';
                obs.style.left = Math.random() * (container.clientWidth - tam) + 'px';
                obs.style.top = Math.random() * (container.clientHeight - tam) + 'px';
                container.appendChild(obs);
            }
        }

        function configurarDificuldade() {
            if(jogoAtivo) return;
            dificuldadeAtual = document.getElementById("difficulty-select").value;
            tempoRestante = TEMPOS[dificuldadeAtual];
            document.getElementById("timer").innerText = `Tempo: ${tempoRestante.toFixed(1)}s`;
            document.getElementById("score").innerText = "0";
            pontos = 0;
            moverBotao();
            carregarRecordes();
        }

        function moverBotao() {
            const x = Math.random() * (container.clientWidth - botao.clientWidth);
            const y = Math.random() * (container.clientHeight - botao.clientHeight);
            botao.style.left = x + 'px';
            botao.style.top = y + 'px';
            if(jogoAtivo) gerarObstaculos();
        }

        function cliqueBotao() {
            // Tocar som de clique
            somClique.currentTime = 0; // Reinicia o som se clicar r√°pido demais
            somClique.play();

            if (!jogoAtivo) {
                const pid = document.getElementById("player-id").value.trim();
                if (!pid) { alert("Digita o teu ID primeiro!"); return; }
                jogoAtivo = true;
                const inicio = Date.now();
                cronometro = setInterval(() => {
                    let decorrido = (Date.now() - inicio) / 1000;
                    tempoRestante = TEMPOS[dificuldadeAtual] - decorrido;
                    if (tempoRestante <= 0) finalizarJogo();
                    document.getElementById("timer").innerText = `Tempo: ${Math.max(0, tempoRestante).toFixed(1)}s`;
                }, 100);
            }
            pontos++;
            document.getElementById("score").innerText = pontos;
            moverBotao();
        }

        function finalizarJogo() {
            clearInterval(cronometro);
            jogoAtivo = false;
            
            // Tocar som de fim de jogo
            somFim.play();

            const pid = document.getElementById("player-id").value;
            db.collection("ranking").add({
                id: pid, score: pontos, dificuldade: dificuldadeAtual,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                alert(`Tempo esgotado! Fizeste ${pontos} pontos.`);
                configurarDificuldade();
            });
        }

        function carregarRecordes() {
            db.collection("ranking").where("dificuldade", "==", dificuldadeAtual)
              .orderBy("score", "desc").limit(10).get().then(snap => {
                document.getElementById("ranking-list").innerHTML = snap.docs.map((doc, i) => 
                    `<div>${i+1}. <b>${doc.data().id}</b> - ${doc.data().score} pts</div>`).join('');
            });
        }

        window.onload = configurarDificuldade;
    </script>
</body>
</html>
    </script>

</body>
</html>

